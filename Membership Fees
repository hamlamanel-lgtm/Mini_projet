<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Membership Fees</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #1f1f23;
      color: #ffffff;
    }

    .sidebar{
        width:90px;
        background:#a476ff;
        border-top-right-radius:40px;
        border-bottom-right-radius:40px;
        display:flex;
        flex-direction:column;
        align-items:center;
        padding-top:25px;
        gap:20px;
        position: fixed;
        left: 0;
        top: 0;
        height: 96vh;
    }

    .icon-box{
        width:55px;
        height:55px;
        background:#8b5cf6;
        border-radius:18px;
        display:flex;
        justify-content:center;
        align-items:center;
        cursor:pointer;
        transition:0.2s;
    }

    .bottom-icon{
        color: black;
        margin-top:auto;
        margin-bottom:20px;
    }

    .container {
      margin-left: 150px;
      padding: 40px;
    }

    h2{
      margin-bottom:20px;
    }

    table {
      width: 80%;
      background-color: #2a2a2e;
      border-radius: 15px;
      overflow: hidden;
      border-collapse: collapse;
    }

    table th, table td {
      padding: 18px;
      border-bottom: 1px solid #4a4a4f;
    }

    table th {
      text-align:left;
      font-weight:600;
    }

    .status-paid{
      color:#4ade80;
      font-weight:bold;
    }

    .status-unpaid{
      color:#f97373;
      font-weight:bold;
    }

    .pay-now {
      position: absolute;
      bottom: 30px;
      right: 40px;
      background-color: #e5d4ff;
      padding: 15px 30px;
      border: none;
      border-radius: 20px;
      font-size: 16px;
      color: #5a3392;
      cursor: pointer;
    }

    /* =======================
       MODAL
    ======================== */
    #paymentPopup {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      justify-content: center;
      align-items: center;
      z-index: 999;
    }

    .popup-box {
      width: 600px;
      background: #11131d;
      padding: 30px;
      border-radius: 18px;
      color: white;
      box-shadow: 0 0 40px rgba(0,0,0,0.5);
      position: relative;
    }

    .popup-box h2 {
      margin-top: 0;
      margin-bottom: 20px;
      font-size: 22px;
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    .field {
      display:flex;
      flex-direction:column;
      gap:6px;
    }

    .field label {
      font-size: 14px;
    }

    .field input {
      width: 100%;
      padding: 12px;
      background: #0f1019;
      border: 1px solid #2e3144;
      border-radius: 10px;
      color: white;
      font-size: 14px;
    }

    .field input[readonly]{
      opacity:0.8;
      cursor:not-allowed;
    }

    .btn-row {
      display: flex;
      justify-content: flex-end;
      gap: 15px;
      margin-top: 25px;
    }

    .cancel-btn,
    .save-btn {
      padding: 10px 22px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-size: 15px;
    }

    .cancel-btn {
      background: #2e3144;
      color: white;
    }

    .save-btn {
      background: #8b5cf6;
      color: white;
    }
    .main-header{
        display:flex;
        justify-content:space-between;
        align-items:center;
    }
        .search-bar{
        background:white;
        padding:8px 15px;
        border-radius:20px;
        display:flex;
        align-items:center;
        color:#333;
        width:180px;
    }
        .profile-circle{
        width:40px;
        height:40px;
        border-radius:50%;
        background:#8b5cf6;
        display:flex;
        justify-content:center;
        align-items:center;
        font-weight:bold;
    }
  </style>
</head>
<body>
  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="icon-box">ğŸ””</div>
    <div class="icon-box" onclick="window.location.href='dashboard.html'">ğŸ </div>
    <div class="icon-box">ğŸ¤</div>
    <div class="icon-box" onclick="window.location.href='Membership_fees.html'">ğŸ’²</div>
    <div class="icon-box">ğŸ‘¥</div>
    <div class="icon-box">ğŸ“</div>
    <div class="icon-box bottom-icon" onclick="window.location.href='Login.html'">â†©</div>
  </aside>

  <!-- MAIN CONTENT -->
  <div class="container">
        <div class="main-header">
        <h2>Membership Fees</h2>

        <div style="display:flex; align-items:center; gap:15px;">
            <div class="search-bar">ğŸ” Search</div>
            <div class="profile-circle" onclick="window.location.href='Profil.html'">P</div>
        </div>
    </div>
    

    <table id="paymentTable">
      <tr>
        <th>Period</th>
        <th>Amount</th>
        <th>Status</th>
      </tr>
      <!-- Ù‡Ù†Ø§ Ù†Ø¶ÙŠÙ Ø³Ø·Ø± Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø§Ø¶ÙŠ Not Paid Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
    </table>
  </div>

  <button class="pay-now" id="payBtn">Pay Now</button>

  <!-- =======================
        POPUP
  ======================== -->
  <div id="paymentPopup">
    <div class="popup-box">
      <h2>Payment Details</h2>
      <div class="form-grid">
        <!-- Ù…Ø¯Ø© Ø§Ù„Ø´Ù‡Ø± -->
        <div class="field">
          <label>Subscription Period</label>
          <input type="text" id="periodText" readonly>
        </div>

        <!-- Ø§Ù„Ù…Ø¨Ù„Øº -->
        <div class="field">
          <label>Amount</label>
          <input type="text" id="payAmount" readonly>
        </div>

        <!-- Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© -->
        <div class="field">
          <label>Golden Card Number (7 digits)</label>
          <input type="text" id="cardNumber" maxlength="7" placeholder="1234567">
        </div>
      </div>

      <div class="btn-row">
        <button class="cancel-btn" onclick="closePopup()">Cancel</button>
        <button class="save-btn" onclick="savePayment()">Save</button>
      </div>
    </div>
  </div>

<script>
  // ------------ Helpers for dates ------------
  function addMonths(date, months) {
    const d = new Date(date);
    d.setMonth(d.getMonth() + months);
    return d;
  }

  function formatDate(date) {
    const y = date.getFullYear();
    const m = String(date.getMonth() + 1).padStart(2, '0');
    const d = String(date.getDate()).padStart(2, '0');
    return `${y}/${m}/${d}`;
  }

  // ------------ Ø¬Ø¯ÙˆÙ„: Ø³Ø·Ø± Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø§Ø¶ÙŠ Not Paid (Ù…Ø«Ø§Ù„ ÙÙ‚Ø·) ------------
  function addLastMonthUnpaidRow() {
    const today = new Date();
    const start = addMonths(today, -1);
    const end = today;

    const period = `${formatDate(start)} â†’ ${formatDate(end)}`;

    const table = document.getElementById("paymentTable");
    const row = table.insertRow(-1);
    row.innerHTML = `
      <td>${period}</td>
      <td>500 DA</td>
      <td class="status-unpaid">Not Paid</td>
    `;
  }

  // ------------ ÙØªØ­ Ø§Ù„Ø¨ÙˆØ¨ Ø£Ø¨ ------------
  document.getElementById("payBtn").addEventListener("click", () => {
    openPopup();
  });

  function openPopup() {
    const today = new Date();
    const end = addMonths(today, 1);

    const periodText = `${formatDate(today)} â†’ ${formatDate(end)}`;
    document.getElementById("periodText").value = periodText;
    document.getElementById("payAmount").value = "500 DA";
    document.getElementById("cardNumber").value = "";

    document.getElementById("paymentPopup").style.display = "flex";
  }

  function closePopup() {
    document.getElementById("paymentPopup").style.display = "none";
  }

  // ------------ Ø­ÙØ¸ Ø§Ù„Ø¯ÙØ¹ ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ (Ùˆ backend Ù„Ø§Ø­Ù‚Ø§Ù‹) ------------
  function savePayment() {
    const period = document.getElementById("periodText").value;
    const card = document.getElementById("cardNumber").value.trim();

    // ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© = 7 Ø£Ø±Ù‚Ø§Ù…
    const cardRegex = /^\d{7}$/;
    if (!cardRegex.test(card)) {
      alert("Golden card number must be exactly 7 digits.");
      return;
    }

    // Ù‡Ù†Ø§ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ:
    // ØªØ±Ø³Ù„ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù€ backend (PHP Ù…Ø«Ù„Ø§Ù‹)
    // Ø¹Ø¨Ø± fetch Ø£Ùˆ form:
    //
    // fetch('pay_membership.php', {
    //   method: 'POST',
    //   body: new URLSearchParams({
    //     period_start: ...,
    //     period_end: ...,
    //     amount: 500,
    //     card_number: card
    //   })
    // }).then(...)

    // Ø§Ù„Ø¢Ù† ÙÙ‚Ø· Ù†Ø¶ÙŠÙ Ø³Ø·Ø± ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ (ÙˆØ§Ø¬Ù‡Ø© Ø£Ù…Ø§Ù…ÙŠØ©)
    const table = document.getElementById("paymentTable");
    const row = table.insertRow(-1);
    row.innerHTML = `
      <td>${period}</td>
      <td>500 DA</td>
      <td class="status-paid">Paid</td>
    `;

    closePopup();
  }

  // Ø£ÙˆÙ„ Ù…Ø§ ØªÙØªØ­ Ø§Ù„ØµÙØ­Ø© Ø£Ø¶ÙŠÙ Ø³Ø·Ø± "Ø´Ù‡Ø± Ù…Ø§Ø¶ÙŠ Not Paid" ÙƒÙ…Ø«Ø§Ù„
  window.addEventListener("DOMContentLoaded", () => {
    addLastMonthUnpaidRow();
  });
</script>
</body>
</html>
